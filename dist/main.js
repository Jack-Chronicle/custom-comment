"use strict";var F=Object.defineProperty;var D=Object.getOwnPropertyDescriptor;var P=Object.getOwnPropertyNames;var R=Object.prototype.hasOwnProperty;var W=(p,e)=>{for(var s in e)F(p,s,{get:e[s],enumerable:!0})},N=(p,e,s,o)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of P(e))!R.call(p,r)&&r!==s&&F(p,r,{get:()=>e[r],enumerable:!(o=D(e,r))||o.enumerable});return p};var U=p=>N(F({},"__esModule",{value:!0}),p);var B={};W(B,{default:()=>I});module.exports=U(B);var v=require("obsidian");var k={template:"%% {cursor} %%"};var b=require("obsidian"),E=class extends b.PluginSettingTab{constructor(e,s){super(e,s),this.plugin=s}display(){let{containerEl:e}=this;e.empty(),new b.Setting(e).setName("Comment Format").setDesc("Use {cursor} wherever you want the cursor to go (e.g. '%% {cursor} %%' or '<!-- {cursor} -->').").addTextArea(s=>s.setValue(this.plugin.settings.template).onChange(async o=>{this.plugin.settings.template=o||"%% {cursor} %%",await this.plugin.saveSettings()}))}};var I=class extends v.Plugin{async onload(){await this.loadSettings(),this.addSettingTab(new E(this.app,this)),this.addCommand({id:"toggle-comment-template",name:"Toggle Comment",editorCallback:e=>this.toggleComment(e)})}async loadSettings(){this.settings=Object.assign({},k,await this.loadData())}async saveSettings(){await this.saveData(this.settings)}insertComment(e){let s=this.settings.template,o=s.indexOf("{cursor}");if(o===-1){e.replaceSelection(s);return}let r=s.slice(0,o),C=s.slice(o+8),c=e.getCursor();e.replaceSelection(r+C);let h=r.split(`
`),u=h.length-1,f=h[h.length-1].length;e.setCursor({line:c.line+u,ch:(u?0:c.ch)+f})}toggleComment(e){let s=this.settings.template,o=s.indexOf("{cursor}"),r=s,C="";o!==-1&&(r=s.slice(0,o),C=s.slice(o+8));let c=r.trim(),h=C.trim(),u=[{start:"%%",end:"%%"},{start:"<!--",end:"-->"},{start:"//",end:""}],f=e.getSelection(),n=e.getCursor(),d,x=e.getCursor("from"),a=e.getCursor("to"),g=null,S=e.getLine(n.line);function A(t,i){let l=/\w+/g,m;for(;(m=l.exec(t))!==null;)if(i>=m.index&&i<=m.index+m[0].length)return{start:m.index,end:m.index+m[0].length};return null}function L(t,i,l){return i?l?t.trim().startsWith(i)&&t.trim().endsWith(l):t.trim().startsWith(i):!1}function G(t,i,l,m){let w=t.indexOf(l),$=m?t.lastIndexOf(m):-1;return l&&m?w!==-1&&$!==-1&&i>=w+l.length&&i<=$:l?w!==-1&&i>=w+l.length:!1}f?d=f:(g=A(S,n.ch),g?(d=S.slice(g.start,g.end),x={line:n.line,ch:g.start},a={line:n.line,ch:g.end}):(d=S,x={line:n.line,ch:0},a={line:n.line,ch:S.length}));let O=c,T=h,y=!1;if(c&&L(d,c,h))y=!0;else for(let t of u)if(t.start&&L(d,t.start,t.end)){O=t.start,T=t.end,y=!0;break}if(y){let t=d,i=0;if(O){let l=new RegExp(`^\\s*${O.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}`),m=t.match(l);m&&(i=m[0].length),t=t.replace(l,"")}if(T){let l=new RegExp(`${T.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}\\s*$`);t=t.replace(l,"")}if(t=t.trim(),f)e.replaceSelection(t),e.setSelection(x,{line:a.line,ch:a.ch-i});else if(g){e.replaceRange(t,{line:n.line,ch:g.start},{line:n.line,ch:g.end});let l=Math.max(g.start,n.ch-i);e.setCursor({line:n.line,ch:l})}else{e.setLine(n.line,t);let l=Math.max(0,n.ch-i);e.setCursor({line:n.line,ch:l})}}else{let t=r+d+C;if(f){e.replaceSelection(t);let i=r.length;e.setSelection({line:x.line,ch:x.ch+i},{line:a.line,ch:a.ch+i})}else if(g){e.replaceRange(t,{line:n.line,ch:g.start},{line:n.line,ch:g.end});let i=n.ch+r.length;e.setCursor({line:n.line,ch:i})}else e.setLine(n.line,t),e.setCursor({line:n.line,ch:n.ch+r.length})}}toggleCommentAtCursor(e){let s=this.settings.template,o=s.indexOf("{cursor}"),r=s,C="";o!==-1&&(r=s.slice(0,o),C=s.slice(o+8));let c=r.trim(),h=C.trim(),u=e.getCursor(),f=e.getLine(u.line),n=f.indexOf(c),d=h?f.lastIndexOf(h):-1,x=!1;if(c&&h?x=n!==-1&&d!==-1&&u.ch>=n+c.length&&u.ch<=d:c&&(x=n!==-1&&u.ch>=n+c.length),x){let a=f;c&&(a=a.replace(c,"")),h&&(a=a.replace(h,"")),a=a.trim(),e.setLine(u.line,a)}}};
//# sourceMappingURL=main.js.map
